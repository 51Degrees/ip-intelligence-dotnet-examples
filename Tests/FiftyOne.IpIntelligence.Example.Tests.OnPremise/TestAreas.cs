/* *********************************************************************
 * This Original Work is copyright of 51 Degrees Mobile Experts Limited.
 * Copyright 2026 51 Degrees Mobile Experts Limited, Davidson House,
 * Forbury Square, Reading, Berkshire, United Kingdom RG1 3EU.
 *
 * This Original Work is licensed under the European Union Public Licence
 * (EUPL) v.1.2 and is subject to its terms as set out below.
 *
 * If a copy of the EUPL was not distributed with this file, You can obtain
 * one at https://opensource.org/licenses/EUPL-1.2.
 *
 * The 'Compatible Licences' set out in the Appendix to the EUPL (as may be
 * amended by the European Commission) shall be deemed incompatible for
 * the purposes of the Work and the provisions of the compatibility
 * clause in Article 5 of the EUPL shall not apply.
 *
 * If using the Work as, or as part of, a network application, by
 * including the attribution notice(s) required under Article 5 of the EUPL
 * in the end user terms of the application under an appropriate heading,
 * such notice(s) shall fulfill the requirements of that article.
 * ********************************************************************* */

// Ignore Spelling: Wkt

using Examples.OnPremise.Areas;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using NetTopologySuite.Geometries;
using System.Data;

namespace FiftyOne.IpIntelligence.Example.Tests.OnPremise;

[TestClass]
public class TestAreas
{
    private static readonly GeometryFactory _factor = new GeometryFactory();

    [TestMethod]
    [DataRow(0, 0, 1, 12323)]
    [DataRow(0, 51, 1, 7725)]
    [DataRow(0, 50.5, 1, 7809)]
    [DataRow(0, 51, 0.1, 78)]
    [DataRow(24.9, 60.1, 0.1, 62)]
    public void TestPolygon(double x, double y, double d, int expected)
    {
        // Act
        var actual = Calculations.GetAreas(CreateRectangle(x, y, d), 0, 0);

        // Assert
        Assert.AreEqual(expected, actual.SquareKms);
    }

    [TestMethod]
    [DataRow("POLYGON ((-0.027 48.061, -0.016 48.091, 0.011 48.119, 0.044 48.144, 1.73 49.11, 1.763 49.127, 1.796 49.135, 1.829 49.143, 2.318 49.215, 3.878 49.415, 3.922 49.415, 4.032 49.415, 4.071 49.415, 4.115 49.407, 4.147 49.393, 4.18 49.377, 4.208 49.358, 4.23 49.333, 4.263 49.294, 4.279 49.267, 4.285 49.239, 4.285 49.209, 4.274 49.182, 4.252 49.157, 4.23 49.132, 4.197 49.113, 4.158 49.097, 0.286 47.855, 0.247 47.844, 0.203 47.839, 0.154 47.841, 0.11 47.85, 0.071 47.861, 0.033 47.88, 0.005 47.905, -0.016 47.932, -0.027 47.96, -0.033 47.99, -0.033 48.031, -0.027 48.061))", 19836)]
    [DataRow("MULTIPOLYGON (((-0.049 39.928, -0.049 39.926, -0.027 39.898, -0.027 39.898, -0.005 39.868, -0.005 39.865, 0 39.843, 0 39.843, 0.005 39.818, 0.005 39.816, 0 39.788, 0 39.785, -0.005 39.761, -0.005 39.758, -0.022 39.728, -0.022 39.725, -0.038 39.706, -0.038 39.703, -0.071 39.678, -0.071 39.676, -0.121 39.651, -0.121 39.648, -0.159 39.637, -0.165 39.637, -0.214 39.629, -0.214 39.629, -0.28 39.632, -0.28 39.632, -0.313 39.64, -0.346 39.651, -0.346 39.651, -0.357 39.656, -0.374 39.667, -0.401 39.681, -0.401 39.681, -0.428 39.703, -0.428 39.703, -0.456 39.731, -0.456 39.733, -0.472 39.763, -0.472 39.766, -0.478 39.788, -0.478 39.788, -0.483 39.81, -0.483 39.813, -0.483 39.843, -0.483 39.843, -0.472 39.871, -0.472 39.873, -0.456 39.904, -0.456 39.904, -0.439 39.926, -0.439 39.926, -0.407 39.953, -0.407 39.953, -0.363 39.98, -0.357 39.98, -0.319 39.994, -0.319 39.994, -0.269 40, -0.269 40, -0.203 39.997, -0.198 39.997, -0.165 39.989, -0.137 39.978, -0.137 39.978, -0.126 39.972, -0.104 39.964, -0.077 39.948, -0.077 39.948, -0.049 39.928)), ((-4.68 39.266, -4.68 39.266, -4.691 39.244, -4.691 39.242, -4.713 39.214, -4.713 39.214, -4.746 39.181, -4.746 39.181, -4.785 39.156, -4.785 39.156, -4.823 39.14, -4.823 39.14, -4.878 39.129, -4.878 39.129, -4.944 39.129, -4.944 39.129, -4.993 39.14, -4.999 39.14, -5.037 39.156, -5.037 39.156, -5.076 39.181, -5.076 39.181, -5.109 39.214, -5.109 39.214, -5.125 39.242, -5.125 39.244, -5.136 39.266, -5.136 39.266, -5.142 39.294, -5.142 39.294, -5.142 39.324, -5.142 39.327, -5.136 39.354, -5.136 39.354, -5.125 39.376, -5.125 39.379, -5.109 39.404, -5.109 39.406, -5.076 39.437, -5.076 39.439, -5.037 39.464, -5.037 39.464, -4.999 39.478, -4.993 39.481, -4.944 39.492, -4.944 39.492, -4.878 39.492, -4.878 39.492, -4.823 39.481, -4.823 39.478, -4.785 39.464, -4.785 39.464, -4.746 39.439, -4.746 39.437, -4.713 39.406, -4.713 39.404, -4.691 39.379, -4.691 39.376, -4.68 39.354, -4.68 39.354, -4.675 39.327, -4.675 39.324, -4.675 39.294, -4.675 39.294, -4.68 39.266)), ((-18.254 27.7, -18.265 27.739, -18.26 27.777, -18.254 27.815, -18.232 27.851, -18.21 27.881, -18.15 27.942, -18.123 27.964, -18.095 27.98, -17.386 28.351, -16.969 28.554, -16.947 28.563, -16.414 28.752, -16.376 28.763, -16.332 28.766, -16.321 28.766, -16.26 28.76, -16.139 28.73, -16.101 28.716, -16.063 28.697, -16.035 28.678, -16.002 28.653, -15.98 28.623, -15.958 28.59, -15.947 28.554, -15.947 28.516, -15.953 28.477, -15.964 28.442, -15.986 28.409, -16.332 27.95, -16.354 27.928, -16.365 27.92, -16.37 27.909, -16.398 27.887, -16.431 27.868, -16.447 27.857, -16.491 27.84, -17.914 27.45, -17.958 27.442, -18.002 27.442, -18.046 27.45, -18.09 27.467, -18.128 27.489, -18.155 27.519, -18.183 27.552, -18.243 27.664, -18.254 27.7)))", 22803)]
    [DataRow("MULTIPOLYGON(((-83.092 39.813,-83.131 39.829,-83.164 39.851,-83.191 39.876,-83.207 39.906,-83.218 39.937,-83.224 39.969,-83.224 40.011,-83.218 40.044,-83.207 40.077,-83.186 40.107,-83.109 40.197,-83.076 40.225,-83.037 40.244,-82.999 40.261,-82.949 40.269,-82.905 40.272,-82.861 40.266,-82.817 40.252,-82.779 40.233,-82.746 40.208,-82.554 40.027,-82.532 40,-82.515 39.969,-82.504 39.939,-82.504 39.906,-82.515 39.873,-82.532 39.843,-82.554 39.813,-82.581 39.791,-82.62 39.772,-82.658 39.758,-82.697 39.75,-82.741 39.747,-82.785 39.752,-83.054 39.802,-83.092 39.813)),((-84.246 36.08,-84.218 36.108,-84.191 36.132,-84.152 36.152,-84.114 36.165,-84.075 36.171,-84.031 36.171,-83.988 36.165,-83.856 36.135,-83.817 36.121,-83.784 36.102,-83.751 36.08,-83.724 36.05,-83.707 36.02,-83.696 35.984,-83.696 35.951,-83.702 35.915,-83.718 35.882,-83.74 35.852,-83.768 35.825,-83.801 35.806,-83.982 35.715,-84.021 35.698,-84.07 35.69,-84.114 35.687,-84.158 35.693,-84.202 35.707,-84.24 35.726,-84.273 35.753,-84.301 35.784,-84.317 35.819,-84.323 35.855,-84.323 35.891,-84.312 35.929,-84.262 36.047,-84.246 36.08)),((-98.468 34.421,-98.512 34.432,-98.55 34.449,-98.583 34.473,-98.611 34.501,-98.627 34.534,-98.644 34.57,-98.655 34.619,-98.655 34.649,-98.655 34.677,-97.891 38.797,-97.88 38.827,-96.902 41.005,-94.782 45.68,-94.765 45.71,-94.738 45.735,-94.7 45.757,-92.299 46.935,-92.266 46.949,-92.233 46.957,-92.085 46.987,-92.041 46.993,-92.002 46.993,-91.964 46.987,-91.925 46.979,-91.892 46.965,-90.338 46.207,-90.299 46.182,-90.272 46.155,-90.255 46.122,-89.085 43.134,-89.074 43.106,-89.074 43.079,-89.08 43.051,-90.415 38.783,-90.415 38.786,-90.376 38.802,-90.332 38.813,-90.288 38.816,-90.222 38.816,-90.173 38.813,-90.135 38.802,-90.102 38.791,-90.063 38.775,-90.03 38.755,-90.003 38.731,-89.986 38.701,-89.97 38.67,-89.964 38.637,-89.97 38.604,-89.975 38.574,-89.997 38.544,-90.019 38.516,-90.151 38.396,-90.179 38.371,-90.217 38.352,-90.261 38.341,-90.305 38.335,-90.349 38.335,-90.393 38.343,-90.437 38.36,-90.47 38.379,-90.503 38.407,-90.525 38.434,-91.48 35.188,-91.491 35.157,-91.513 35.13,-91.535 35.105,-91.947 34.745,-91.953 34.737,-92.096 34.627,-92.118 34.611,-92.37 34.46,-92.409 34.443,-92.486 34.413,-92.53 34.399,-93.09 34.289,-93.145 34.284,-98.43 34.416,-98.468 34.421)),((-96.891 43.677,-96.842 43.694,-96.803 43.705,-96.754 43.713,-96.705 43.713,-96.655 43.705,-96.578 43.683,-96.54 43.672,-96.501 43.653,-96.474 43.631,-96.452 43.606,-96.435 43.576,-96.424 43.546,-96.424 43.513,-96.435 43.485,-96.452 43.455,-96.474 43.43,-96.501 43.408,-96.54 43.389,-96.578 43.375,-96.655 43.356,-96.694 43.348,-96.732 43.348,-96.809 43.348,-96.853 43.351,-96.897 43.359,-96.935 43.375,-96.968 43.395,-96.996 43.419,-97.018 43.447,-97.029 43.477,-97.034 43.507,-97.029 43.54,-97.018 43.57,-97.001 43.598,-96.968 43.623,-96.93 43.653,-96.891 43.677)),((-96.803 47.034,-96.76 47.031,-96.716 47.023,-96.672 47.015,-96.633 47.001,-96.6 46.984,-96.567 46.962,-96.545 46.938,-96.534 46.91,-96.523 46.88,-96.529 46.85,-96.534 46.822,-96.556 46.795,-96.578 46.77,-96.611 46.751,-96.644 46.735,-96.683 46.724,-96.727 46.718,-96.869 46.707,-96.913 46.707,-96.952 46.713,-96.996 46.724,-97.034 46.74,-97.062 46.762,-97.089 46.787,-97.106 46.817,-97.117 46.844,-97.111 46.877,-97.106 46.905,-97.089 46.932,-97.062 46.957,-97.029 46.979,-96.996 46.995,-96.952 47.006,-96.853 47.026,-96.803 47.034)),((-101.16 46.74,-101.193 46.762,-101.215 46.787,-101.237 46.814,-101.242 46.842,-101.242 46.872,-101.237 46.902,-101.22 46.932,-101.193 46.957,-101.165 46.979,-101.127 46.995,-101.088 47.006,-101.044 47.012,-101 47.012,-100.956 47.006,-100.715 46.957,-100.671 46.946,-100.638 46.927,-100.605 46.905,-100.577 46.88,-100.561 46.85,-100.555 46.82,-100.555 46.789,-100.566 46.759,-100.588 46.732,-100.616 46.707,-100.649 46.685,-100.687 46.666,-100.726 46.652,-100.764 46.641,-100.803 46.636,-100.847 46.636,-100.885 46.641,-100.923 46.652,-101.121 46.724,-101.16 46.74)),((-101.984 35.352,-101.951 35.369,-101.912 35.385,-101.868 35.391,-101.824 35.394,-101.786 35.388,-101.747 35.377,-101.709 35.358,-101.676 35.336,-101.649 35.308,-101.632 35.278,-101.621 35.245,-101.616 35.21,-101.616 35.171,-101.621 35.135,-101.632 35.1,-101.654 35.067,-101.682 35.039,-101.715 35.017,-101.753 35.001,-101.797 34.99,-101.841 34.987,-101.879 34.987,-101.923 34.99,-101.973 35.001,-102.011 35.02,-102.044 35.045,-102.072 35.075,-102.094 35.108,-102.105 35.146,-102.105 35.182,-102.094 35.22,-102.077 35.256,-102.055 35.286,-102.017 35.325,-101.984 35.352)),((-103.231 44.279,-103.192 44.298,-103.148 44.306,-103.104 44.312,-103.055 44.309,-103.011 44.298,-102.973 44.282,-102.934 44.263,-102.901 44.243,-102.874 44.219,-102.852 44.191,-102.841 44.161,-102.835 44.131,-102.841 44.1,-102.852 44.073,-102.868 44.046,-102.896 44.021,-102.929 43.999,-103.115 43.9,-103.154 43.883,-103.198 43.872,-103.242 43.867,-103.286 43.87,-103.324 43.878,-103.368 43.892,-103.401 43.911,-103.428 43.933,-103.45 43.96,-103.467 43.991,-103.472 44.021,-103.472 44.054,-103.461 44.084,-103.445 44.111,-103.417 44.139,-103.269 44.257,-103.231 44.279)),((-106.296 37.443,-106.323 37.467,-106.345 37.495,-106.362 37.525,-106.373 37.558,-106.373 37.591,-106.367 37.624,-105.51 40.283,-105.368 40.64,-105.357 40.659,-105.038 41.216,-105.016 41.247,-104.989 41.271,-104.956 41.291,-104.917 41.307,-104.873 41.315,-104.829 41.318,-104.807 41.318,-104.769 41.315,-104.725 41.307,-104.686 41.291,-104.653 41.271,-103.461 40.392,-103.434 40.368,-103.417 40.34,-103.401 40.31,-103.395 40.277,-103.395 40.247,-103.406 40.214,-104.329 38.132,-104.346 38.102,-104.368 38.077,-104.395 38.052,-104.434 38.036,-105.955 37.382,-105.994 37.368,-106.038 37.363,-106.082 37.363,-106.126 37.371,-106.17 37.385,-106.258 37.426,-106.296 37.443)),((-106.9 35.242,-106.884 35.275,-106.862 35.306,-106.834 35.333,-106.801 35.355,-106.763 35.369,-106.724 35.38,-106.681 35.383,-106.637 35.38,-106.598 35.369,-106.56 35.355,-106.527 35.333,-106.499 35.306,-106.428 35.226,-106.406 35.199,-106.395 35.168,-106.373 35.108,-106.367 35.075,-106.367 35.042,-106.373 35.006,-106.389 34.976,-106.411 34.946,-106.439 34.921,-106.477 34.902,-106.516 34.888,-106.615 34.858,-106.659 34.847,-106.702 34.847,-106.741 34.85,-106.785 34.863,-106.823 34.883,-106.856 34.905,-106.884 34.935,-106.9 34.968,-106.911 35.004,-106.917 35.039,-106.906 35.21,-106.9 35.242)),((-108.477 45.982,-108.438 45.985,-108.438 45.985,-108.383 45.982,-108.383 45.982,-108.345 45.976,-108.312 45.965,-108.312 45.965,-108.274 45.949,-108.274 45.949,-108.235 45.922,-108.235 45.919,-108.219 45.902,-108.213 45.9,-108.197 45.872,-108.197 45.872,-108.191 45.856,-108.191 45.853,-108.186 45.828,-108.186 45.825,-108.186 45.809,-108.186 45.806,-108.197 45.779,-108.197 45.776,-108.202 45.759,-108.202 45.757,-108.224 45.729,-108.224 45.729,-108.252 45.705,-108.257 45.702,-108.279 45.688,-108.279 45.688,-108.312 45.674,-108.389 45.644,-108.411 45.636,-108.411 45.636,-108.444 45.63,-108.482 45.625,-108.482 45.625,-108.537 45.625,-108.537 45.625,-108.576 45.633,-108.609 45.644,-108.609 45.644,-108.647 45.661,-108.647 45.661,-108.686 45.688,-108.686 45.688,-108.708 45.713,-108.708 45.716,-108.719 45.732,-108.719 45.732,-108.73 45.754,-108.73 45.757,-108.735 45.781,-108.735 45.784,-108.735 45.801,-108.735 45.803,-108.724 45.831,-108.724 45.834,-108.719 45.85,-108.719 45.853,-108.697 45.88,-108.697 45.88,-108.669 45.905,-108.664 45.908,-108.642 45.922,-108.642 45.924,-108.609 45.935,-108.532 45.965,-108.51 45.971,-108.51 45.974,-108.477 45.982)),((-108.669 38.898,-108.702 38.915,-108.735 38.939,-108.757 38.967,-108.773 38.997,-108.784 39.027,-108.784 39.06,-108.779 39.093,-108.757 39.154,-108.741 39.184,-108.724 39.211,-108.697 39.236,-108.664 39.255,-108.625 39.272,-108.587 39.28,-108.543 39.283,-108.504 39.283,-108.46 39.272,-108.394 39.253,-108.356 39.239,-108.318 39.22,-108.29 39.195,-108.268 39.167,-108.252 39.137,-108.246 39.104,-108.246 39.071,-108.257 39.041,-108.274 39.011,-108.29 38.981,-108.312 38.953,-108.345 38.928,-108.372 38.909,-108.411 38.887,-108.455 38.874,-108.499 38.865,-108.543 38.865,-108.587 38.874,-108.631 38.885,-108.669 38.898)),((-109.405 41.461,-109.438 41.488,-109.466 41.521,-109.477 41.554,-109.488 41.59,-109.488 41.639,-109.482 41.672,-109.466 41.705,-109.444 41.736,-109.416 41.76,-109.383 41.782,-109.339 41.796,-109.295 41.804,-109.251 41.807,-109.207 41.804,-109.163 41.793,-109.125 41.774,-109.092 41.752,-109.065 41.727,-109.026 41.675,-109.01 41.648,-108.999 41.628,-108.988 41.596,-108.988 41.563,-108.993 41.53,-109.01 41.497,-109.032 41.469,-109.065 41.442,-109.098 41.425,-109.142 41.409,-109.185 41.403,-109.229 41.403,-109.273 41.409,-109.317 41.422,-109.367 41.442,-109.405 41.461)),((-112.542 40.458,-112.553 40.508,-112.822 43.098,-112.822 43.134,-112.811 43.169,-112.789 43.202,-112.015 44.04,-111.987 44.065,-111.954 44.084,-111.916 44.1,-111.872 44.109,-111.723 44.128,-111.679 44.131,-111.635 44.128,-111.592 44.117,-111.553 44.103,-111.52 44.081,-111.493 44.057,-111.471 44.029,-111.46 43.999,-111.41 43.798,-111.405 43.776,-111.267 40.747,-111.267 40.711,-111.344 39.343,-111.35 39.313,-111.361 39.286,-111.377 39.261,-111.449 39.17,-111.476 39.143,-111.509 39.118,-111.548 39.102,-111.592 39.091,-111.635 39.085,-111.679 39.088,-111.723 39.099,-111.762 39.115,-111.795 39.134,-111.828 39.162,-111.85 39.192,-112.525 40.434,-112.542 40.458)),((-116.761 43.428,-116.794 43.447,-116.821 43.474,-116.838 43.499,-116.898 43.609,-116.915 43.65,-116.915 43.688,-116.893 43.818,-116.887 43.848,-116.854 43.919,-116.838 43.949,-116.81 43.977,-116.772 43.999,-116.733 44.018,-116.689 44.029,-116.64 44.032,-116.492 44.032,-116.442 44.029,-116.393 44.018,-116.354 43.999,-116.316 43.974,-115.959 43.664,-115.931 43.636,-115.915 43.606,-115.904 43.573,-115.909 43.54,-115.915 43.507,-115.937 43.477,-115.964 43.452,-115.997 43.43,-116.036 43.411,-116.069 43.403,-116.091 43.395,-116.354 43.334,-116.393 43.329,-116.437 43.326,-116.475 43.331,-116.514 43.342,-116.722 43.411,-116.761 43.428)),((-117.03 47.627,-117.03 47.624,-117.041 47.608,-117.041 47.608,-117.052 47.583,-117.057 47.583,-117.085 47.556,-117.085 47.553,-117.123 47.531,-117.123 47.531,-117.162 47.515,-117.162 47.515,-117.222 47.501,-117.222 47.501,-117.261 47.498,-117.299 47.501,-117.299 47.501,-117.354 47.515,-117.36 47.515,-117.398 47.531,-117.398 47.531,-117.436 47.553,-117.436 47.556,-117.464 47.583,-117.464 47.583,-117.48 47.608,-117.48 47.608,-117.486 47.624,-117.491 47.627,-117.491 47.646,-117.491 47.649,-117.491 47.671,-117.491 47.674,-117.491 47.693,-117.486 47.696,-117.48 47.712,-117.48 47.712,-117.464 47.737,-117.464 47.737,-117.436 47.765,-117.436 47.767,-117.398 47.789,-117.398 47.789,-117.36 47.806,-117.354 47.806,-117.299 47.817,-117.299 47.817,-117.261 47.819,-117.222 47.817,-117.222 47.817,-117.162 47.806,-117.162 47.806,-117.123 47.789,-117.123 47.789,-117.085 47.767,-117.085 47.765,-117.057 47.737,-117.052 47.737,-117.041 47.712,-117.041 47.712,-117.03 47.696,-117.03 47.693,-117.024 47.674,-117.024 47.671,-117.024 47.649,-117.024 47.646,-117.03 47.627)),((-117.909 33.943,-117.903 33.943,-117.843 33.946,-117.843 33.946,-117.799 33.938,-117.794 33.938,-117.761 33.927,-117.755 33.924,-117.711 33.899,-117.706 33.899,-117.678 33.869,-117.673 33.869,-117.651 33.839,-117.651 33.836,-117.64 33.817,-117.64 33.817,-117.629 33.778,-117.629 33.776,-117.629 33.74,-117.629 33.74,-117.629 33.713,-117.629 33.71,-117.64 33.688,-117.64 33.685,-117.662 33.649,-117.662 33.649,-117.684 33.619,-117.689 33.619,-117.722 33.592,-117.728 33.589,-117.739 33.581,-117.837 33.531,-117.848 33.526,-117.854 33.526,-117.914 33.509,-117.914 33.509,-117.975 33.504,-117.975 33.504,-118.024 33.512,-118.024 33.512,-118.063 33.523,-118.063 33.526,-118.112 33.551,-118.112 33.551,-118.145 33.578,-118.145 33.581,-118.167 33.611,-118.167 33.614,-118.178 33.633,-118.178 33.633,-118.189 33.671,-118.189 33.674,-118.195 33.71,-118.195 33.71,-118.189 33.737,-118.189 33.74,-118.184 33.762,-118.178 33.765,-118.162 33.8,-118.162 33.8,-118.134 33.831,-118.134 33.831,-118.107 33.853,-118.107 33.853,-118.079 33.869,-117.98 33.919,-117.969 33.924,-117.969 33.924,-117.909 33.943)))", 917104)]
    public void TestWkt(string wkt, int expected)
    {
        // Act
        var actual = Calculations.GetAreas(wkt, 0, 0);

        // Assert
        Assert.AreEqual(expected, actual.SquareKms);
    }

    private static Polygon CreateRectangle(double x, double y, double d)
    {
        return _factor.CreatePolygon([
            new Coordinate(x, y),
            new Coordinate(x + d, y),
            new Coordinate(x + d, y + d),
            new Coordinate(x, y + d),
            new Coordinate(x, y)]);
    }
}
