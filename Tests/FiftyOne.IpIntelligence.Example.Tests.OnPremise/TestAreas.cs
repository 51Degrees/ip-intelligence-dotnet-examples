// Ignore Spelling: Wkt

using Examples.OnPremise.Areas;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using NetTopologySuite.Geometries;
using System.Data;

namespace FiftyOne.IpIntelligence.Example.Tests.OnPremise;

[TestClass]
public class TestAreas
{
    private static readonly GeometryFactory _factor = new GeometryFactory();

    [TestMethod]
    [DataRow(0, 0, 1, 12323)]
    [DataRow(0, 51, 1, 7725)]
    [DataRow(0, 50.5, 1, 7809)]
    [DataRow(0, 51, 0.1, 78)]
    [DataRow(24.9, 60.1, 0.1, 62)]
    public void TestPolygon(double x, double y, double d, int expected)
    {
        // Act
        var actual = Calculations.GetAreas(CreateRectangle(x, y, d), 0, 0);

        // Assert
        Assert.AreEqual(expected, actual.SquareKms);
    }

    [TestMethod]
    [DataRow("POLYGON ((-0.027 48.061, -0.016 48.091, 0.011 48.119, 0.044 48.144, 1.73 49.11, 1.763 49.127, 1.796 49.135, 1.829 49.143, 2.318 49.215, 3.878 49.415, 3.922 49.415, 4.032 49.415, 4.071 49.415, 4.115 49.407, 4.147 49.393, 4.18 49.377, 4.208 49.358, 4.23 49.333, 4.263 49.294, 4.279 49.267, 4.285 49.239, 4.285 49.209, 4.274 49.182, 4.252 49.157, 4.23 49.132, 4.197 49.113, 4.158 49.097, 0.286 47.855, 0.247 47.844, 0.203 47.839, 0.154 47.841, 0.11 47.85, 0.071 47.861, 0.033 47.88, 0.005 47.905, -0.016 47.932, -0.027 47.96, -0.033 47.99, -0.033 48.031, -0.027 48.061))", 19836)]
    [DataRow("MULTIPOLYGON (((-0.049 39.928, -0.049 39.926, -0.027 39.898, -0.027 39.898, -0.005 39.868, -0.005 39.865, 0 39.843, 0 39.843, 0.005 39.818, 0.005 39.816, 0 39.788, 0 39.785, -0.005 39.761, -0.005 39.758, -0.022 39.728, -0.022 39.725, -0.038 39.706, -0.038 39.703, -0.071 39.678, -0.071 39.676, -0.121 39.651, -0.121 39.648, -0.159 39.637, -0.165 39.637, -0.214 39.629, -0.214 39.629, -0.28 39.632, -0.28 39.632, -0.313 39.64, -0.346 39.651, -0.346 39.651, -0.357 39.656, -0.374 39.667, -0.401 39.681, -0.401 39.681, -0.428 39.703, -0.428 39.703, -0.456 39.731, -0.456 39.733, -0.472 39.763, -0.472 39.766, -0.478 39.788, -0.478 39.788, -0.483 39.81, -0.483 39.813, -0.483 39.843, -0.483 39.843, -0.472 39.871, -0.472 39.873, -0.456 39.904, -0.456 39.904, -0.439 39.926, -0.439 39.926, -0.407 39.953, -0.407 39.953, -0.363 39.98, -0.357 39.98, -0.319 39.994, -0.319 39.994, -0.269 40, -0.269 40, -0.203 39.997, -0.198 39.997, -0.165 39.989, -0.137 39.978, -0.137 39.978, -0.126 39.972, -0.104 39.964, -0.077 39.948, -0.077 39.948, -0.049 39.928)), ((-4.68 39.266, -4.68 39.266, -4.691 39.244, -4.691 39.242, -4.713 39.214, -4.713 39.214, -4.746 39.181, -4.746 39.181, -4.785 39.156, -4.785 39.156, -4.823 39.14, -4.823 39.14, -4.878 39.129, -4.878 39.129, -4.944 39.129, -4.944 39.129, -4.993 39.14, -4.999 39.14, -5.037 39.156, -5.037 39.156, -5.076 39.181, -5.076 39.181, -5.109 39.214, -5.109 39.214, -5.125 39.242, -5.125 39.244, -5.136 39.266, -5.136 39.266, -5.142 39.294, -5.142 39.294, -5.142 39.324, -5.142 39.327, -5.136 39.354, -5.136 39.354, -5.125 39.376, -5.125 39.379, -5.109 39.404, -5.109 39.406, -5.076 39.437, -5.076 39.439, -5.037 39.464, -5.037 39.464, -4.999 39.478, -4.993 39.481, -4.944 39.492, -4.944 39.492, -4.878 39.492, -4.878 39.492, -4.823 39.481, -4.823 39.478, -4.785 39.464, -4.785 39.464, -4.746 39.439, -4.746 39.437, -4.713 39.406, -4.713 39.404, -4.691 39.379, -4.691 39.376, -4.68 39.354, -4.68 39.354, -4.675 39.327, -4.675 39.324, -4.675 39.294, -4.675 39.294, -4.68 39.266)), ((-18.254 27.7, -18.265 27.739, -18.26 27.777, -18.254 27.815, -18.232 27.851, -18.21 27.881, -18.15 27.942, -18.123 27.964, -18.095 27.98, -17.386 28.351, -16.969 28.554, -16.947 28.563, -16.414 28.752, -16.376 28.763, -16.332 28.766, -16.321 28.766, -16.26 28.76, -16.139 28.73, -16.101 28.716, -16.063 28.697, -16.035 28.678, -16.002 28.653, -15.98 28.623, -15.958 28.59, -15.947 28.554, -15.947 28.516, -15.953 28.477, -15.964 28.442, -15.986 28.409, -16.332 27.95, -16.354 27.928, -16.365 27.92, -16.37 27.909, -16.398 27.887, -16.431 27.868, -16.447 27.857, -16.491 27.84, -17.914 27.45, -17.958 27.442, -18.002 27.442, -18.046 27.45, -18.09 27.467, -18.128 27.489, -18.155 27.519, -18.183 27.552, -18.243 27.664, -18.254 27.7)))", 22803)]
    [DataRow("MULTIPOLYGON (((-0.363 38.291,-0.346 38.264,-0.346 38.261,-0.341 38.234,-0.341 38.231,-0.335 38.206,-0.335 38.203,-0.341 38.176,-0.341 38.173,-0.352 38.146,-0.352 38.146,-0.368 38.118,-0.368 38.118,-0.39 38.091,-0.396 38.088,-0.428 38.063,-0.428 38.063,-0.472 38.041,-0.472 38.041,-0.522 38.028,-0.527 38.028,-0.582 38.025,-0.582 38.025,-0.637 38.033,-0.637 38.033,-0.687 38.05,-0.687 38.05,-0.725 38.072,-0.731 38.074,-0.758 38.099,-0.758 38.102,-0.769 38.113,-0.989 38.404,1 38.418,1 38.42,-1.016 38.448,-1.016 38.448,-1.022 38.475,-1.022 38.478,-1.022 38.506,-1.022 38.508,-1.022 38.533,-1.016 38.536,-1.011 38.563,-1.011 38.563,-0.994 38.591,-0.994 38.593,-0.967 38.618,-0.967 38.621,-0.934 38.646,-0.934 38.646,-0.89 38.668,-0.89 38.668,-0.835 38.681,-0.835 38.681,-0.78 38.684,-0.78 38.684,-0.725 38.676,-0.72 38.676,-0.676 38.659,-0.67 38.659,-0.632 38.637,-0.632 38.637,-0.604 38.61,-0.599 38.61,-0.588 38.596,-0.368 38.305,-0.363 38.291,-0.363 38.291)),((-2.296 41.966,-2.335 41.98,-2.368 42.002,-2.395 42.027,-2.417 42.057,-2.428 42.087,-2.434 42.12,-2.428 42.153,-2.417 42.183,-2.368 42.274,-2.285 42.414,-2.28 42.422,-2.263 42.452,-2.236 42.48,-2.208 42.505,-2.17 42.524,-2.131 42.538,-2.087 42.546,-1.967 42.554,-1.923 42.554,-1.879 42.549,-1.835 42.538,-1.796 42.518,-1.769 42.496,-1.599 42.348,-1.571 42.315,-1.555 42.279,-1.533 42.219,-1.527 42.186,-1.527 42.153,-1.544 42.12,-1.56 42.09,-1.588 42.062,-1.626 42.043,-1.664 42.027,-1.708 42.016,-2.071 41.966,-2.164 41.955,-2.197 41.953,-2.208 41.953,-2.252 41.955,-2.296 41.966)),((-6.026 38.978,-6.065 38.994,-6.098 39.016,-6.131 39.044,-6.147 39.074,-6.164 39.107,-6.164 39.143,-6.158 39.176,-6.147 39.209,-6.125 39.239,-6.098 39.266,-6.065 39.286,-6.004 39.316,-5.96 39.332,-5.916 39.34,-5.872 39.343,-5.828 39.338,-5.784 39.327,-5.746 39.31,-5.713 39.286,-5.686 39.258,-5.669 39.225,-5.658 39.192,-5.658 39.156,-5.664 39.124,-5.68 39.091,-5.702 39.06,-5.724 39.033,-5.752 39.011,-5.784 38.992,-5.817 38.978,-5.861 38.967,-5.9 38.967,-5.938 38.967,-5.982 38.97,-6.026 38.978)))", 7579)]
    public void TestWkt(string wkt, int expected)
    {
        // Act
        var actual = Calculations.GetAreas(wkt, 0, 0);

        // Assert
        Assert.AreEqual(expected, actual.SquareKms);
    }

    private static Polygon CreateRectangle(double x, double y, double d)
    {
        return _factor.CreatePolygon([
            new Coordinate(x, y),
            new Coordinate(x + d, y),
            new Coordinate(x + d, y + d),
            new Coordinate(x, y + d),
            new Coordinate(x, y)]);
    }
}
